# Perrys-Messaging-Service
### Steps before using code
* The unit tests require an AWS access key ID and secret key 
* Replace the values for AWS_ACCESS_KEY_ID and AWS_SECRET_KEY in Credentials.java to those generated in the IAM console
* Alternatively: remove the integration tests (no other code requires this)
````
public class Credentials {
    public static String AWS_ACCESS_KEY_ID = "YOUR_ACCESS_KEY_ID";
    public static String AWS_SECRET_KEY = "YOUR_SECRET_KEY";
}
````

### Using the API
* The API is deployed at: https://3c0seyrda9.execute-api.eu-west-1.amazonaws.com/Production
*POST   /users/createuser*
* Parameters: 
    * username - string
*  Returns:
````
{
    "body": {
        "userId": STRING,
        "username": STRING
    },
    "statusCode": INT
}
````
The userId returned is generated by the Lambda function and can be used to referenced that user

*GET   /users/getusers*
* Parameters: (none)
*  Returns:
````
[
    {
        "userId": STRING,
        "username": STRING
    },
    ...etc
]
````
Returns all users in the database

*POST   /messages/createmessage*
* Parameters: 
    * senderUserId - string
    * recipientUserId - string
    * body - string
*  Returns:
````
{
    "body": {
        "senderUserId": STRING,
        "recipientUserId": STRING,
        "body": STRING,
        "messageId": STRING,
        "lastUpdated": LONG
    },
    "statusCode": INT
}
````
The messageId returned is generated by the Lambda function and can be used to referenced that user
The lastUpdated is the timestamp generated by the Lambda function that shows when the message was last changed
POSSIBLE IMPROVEMENT: For both the senderUserId and recipientUserId, check do users exist in the database with those userIds. If not, return an error message.

*GET   /messages/getmessages*
* Parameters: (none)
*  Returns:
````
[
    {
        "messageId": STRING,
        "lastUpdated": STRING,
        "body": STRING,
        "recipientUserId": STRING,
        "senderUserId": STRING
    },
    ...etc
]
````
Returns all messages in the database
POSSIBLE IMPROVEMENT: Return the timestamps as numbers rather than strings
